<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Step 1</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 45px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h2 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h3 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h4 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h5 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h6 {
  padding-top: 50px;
  margin-top: -50px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">HOME</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Resources.html">Resources</a>
</li>
<li>
  <a href="Background.html">Background</a>
</li>
<li>
  <a href="Step_1.html">Step 1</a>
</li>
<li>
  <a href="Step_2.html">Step 2</a>
</li>
<li>
  <a href="Step_3.html">Step 3</a>
</li>
<li>
  <a href="Step_4.html">Step 4</a>
</li>
<li>
  <a href="Assignment.html">Assignment</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Step 1</h1>

</div>


<div id="calculating-the-charge-of-a-peptide" class="section level2">
<h2>Calculating the charge of a peptide</h2>
<p>Net peptide charge can be represented as the sum of the charge on each individual amino acid in the peptide sequence. Of the 20 common amino acids, seven can be ionized under normal conditions to produce charged species. Three of these seven (lysine, arginine, histidine) are considered basic. They gain a proton to become positively charged when the pH is below their pKa. Four are considered acidic (cysteine, tyrosine, glutamic acid, aspartic acid), and these lose a proton to become negatively charged when the pH is above their pKa. In addition to the residues themselves, the N-terminus of the peptide is basic, and can become positively charged, and the C-terminus is acidic, and can become negatively charged. All together, that is 9 ionizable groups that must be considered when calculating the net charge of the peptide. (Other groups can occasionally be ionized and contribute to the charge, but they are outside the scope of this project.)</p>
<p>However, just because the pH is above or below an ionizable group’s pKa doesn’t mean that all of the residues will be protonated/unprotonated. The fraction of a species that is protonated is a term in the Henderson-Hasselbalch equation (<span class="math inline">\(pH = pK_a + log_{10}(\frac{[base]}{[acid]})\)</span>), which can be rearranged to show the ratio of [base]/[acid] or [acid]/[base] as a function of pKa and pH. <span class="math display">\[\begin{equation}
\tag{1}
\frac{[base]}{[acid]} = 10^{(pH-pK_a)}
\end{equation}\]</span> <span class="math display">\[\begin{equation}
\tag{2}
\frac{[acid]}{[base]} = 10^{(pK_a-pH)}
\end{equation}\]</span> For ‘basic’ residues (and the N-terminus), the charged (+) state is when they are protonated, or in their ‘acid’ form. For this, the fraction that are protonated can be given by: <span class="math display">\[\begin{equation}
\tag{3}
f=\frac{[acid]}{[acid] + [base]}
\end{equation}\]</span> This can be rearranged and substituted with equation 2, to give the fraction of the residue that is charged (and therefore the average or measurable charge (z) of a population) as a function of pH and pKa: <span class="math display">\[\begin{equation}
\tag{4}
z_{basic}=\frac{10^{(pK_a-pH)}}{10^{(pK_a-pH)} + 1}
\end{equation}\]</span> For acidic residues (and the C-terminus), the same derivation can be performed using equation 1 to obtain the charge (z) as a function of pH and pKa. (Note that it is (-) because the charged state is the lack of a proton, and therefore a negative charge) <span class="math display">\[\begin{equation}
\tag{5}
z_{acidic}=-(\frac{10^{(pH-pK_a)}}{10^{(pH-pK_a)} + 1})
\end{equation}\]</span> From these equations, we can calculate the charge on any one residue (or terminus) if we know three things:</p>
<ul>
<li>The species’ pKa</li>
<li>Whether it is acidic or basic</li>
<li>The pH.</li>
</ul>
<p>Then by counting the number of each ionizable group in a peptide, we can add up their respective charges to arrive at a net charge for the peptide at any given pH. (For a more complete derivation of these equations, see <a href="https://pubs.acs.org/doi/abs/10.1021/ed100232j">this</a> article)</p>
</div>
<div id="code" class="section level2">
<h2>Code</h2>
<p>The function below: <code>pep_charge()</code>, takes two arguments: <code>peptide</code> which is a variable that corresponds to a peptide written out in one letter code, and <code>pH</code> which is a number between 0 and 14 designating the pH of interest. You can copy and paste this entire block of code into the ‘.R’ file in your code editor, highlight it, and click run to have the function available to you. (You will need to add the <code>stringr</code> package if you don’t already have it installed. See the step by step instructions in the ‘Resources’ tab or <a href="http://derekogle.com/IFAR/supplements/installations/InstallPackagesRStudio.html">this link</a> for installing R packages.)</p>
<pre class="r"><code>#load required packages
library(&#39;stringr&#39;)


#Calculate Charge of a peptide at a specific pH
pep_charge &lt;- function(peptide, pH = 7) {
  
  #convert any lowercase to uppercase
  peptide &lt;- toupper(peptide)
  
  #create charge dataframe. This has a row for each ionizable group (&#39;ion group&#39;),
  #with its corresponding type of ion (basic or acidic - &#39;ion type&#39;),
  #and an approximated pKa (&#39;pKa&#39;). These pKa values can be updated for different situations
  ion_group &lt;- c(&#39;N_term&#39;, &#39;H&#39;, &#39;K&#39;, &#39;R&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;Y&#39;, &#39;C_term&#39;)
  ion_type &lt;- c(&#39;basic&#39;, &#39;basic&#39;, &#39;basic&#39;, &#39;basic&#39;, &#39;acidic&#39;, &#39;acidic&#39;, &#39;acidic&#39;, &#39;acidic&#39;, &#39;acidic&#39;)
  #EMBOSS pKas
  pKa &lt;- c(8.6, 6.5, 10.8, 12.5, 8.5, 3.9, 4.1, 10.1, 3.6)
  net_charge_df &lt;- data.frame(ion_group, ion_type, pKa)
  
  #add a column for counting the number of each potentially charged residue, set at 0 to start
  net_charge_df$count &lt;- 0
  #for each residue of interest, count the number of occurrences in the peptide
  for (i in 1:nrow(net_charge_df)) {
    net_charge_df$count[i] &lt;- str_count(peptide, net_charge_df$ion_group[i])
  }
  #set the number of occurences of the n-termini and c-termini to one each
  net_charge_df$count[net_charge_df$ion_group == &#39;N_term&#39;] &lt;- 1
  net_charge_df$count[net_charge_df$ion_group == &#39;C_term&#39;] &lt;- 1
  
  #create a column that stores the charge of a single instance of each ionizable group at the given pH.
  #set it to zero to start
  net_charge_df$single_charge &lt;- 0
  
  #check if each ionizable group is acidic or basic.
  #calculate the charge for a single instance of each group. For the acidic groups, this charge will be negative (lost a proton)
  #these are calculated by determining the fraction of the group that is protonated vs. not protonated using the supplied pH and pKa values
  for (i in 1:nrow(net_charge_df)){
    if (net_charge_df$ion_type[i] == &#39;basic&#39;) {
      net_charge_df$single_charge[i] &lt;- (10^(net_charge_df$pKa[i] - pH))/((10^(net_charge_df$pKa[i] - pH)) + 1)
    }
    if (net_charge_df$ion_type[i] == &#39;acidic&#39;) {
      net_charge_df$single_charge[i] &lt;- -(10^(pH - net_charge_df$pKa[i]))/((10^(pH - net_charge_df$pKa[i])) + 1)
    }
  }
  
  #create a new column that is the net charge for each ionizable group (simply the charge of one instance * number of instances)
  net_charge_df$net_charge &lt;- net_charge_df$count * net_charge_df$single_charge
  
  #sum all of the individual net charges to produce a total net charge of the peptide.
  total_net_charge &lt;- sum(net_charge_df$net_charge)
  
  #print the dataframe. This can be commented in or out depending on whether this information is wanted
  print(net_charge_df)

  #return the net charge value
  return(total_net_charge)
}</code></pre>
<p><em>Quick Description of the code:</em></p>
<p><em>First we convert the peptide variable to all uppercase letters. Then we create a dataframe (type of table or matrix with columns and rows) that contains all the ionizable groups in one column, their corresponding basic or acidic designation in the next, and their pKa value in the third column. We add a column that counts the number of instances of each group in the peptide, and assign that value to the count column. Next we make a column that keeps track of the charge for one instance of each group. The ‘if’ statements nested within the ‘for loop’ do the hard work of actually calculating the charge for each residue. They check whether the group is basic or acidic, and then apply the correct equation. From there, we just multiply the charge by the number of instances of that group, and then add up all the charges. We can print the dataframe to see exactly how we got to the final number, and we return the total net charge</em></p>
<p>It is important to note that there are multiple options for the set of pKa values. The ones in the code above come from the <a href="https://www.ebi.ac.uk/Tools/emboss/">EMBOSS</a> tools, but you could easily replace these with several other sets. One activity could be updating these pKa values with those from another source, and seeing how much the final peptide charge changes. It is also important to acknowledge that local environment can influence the pKa of any ionizable group.</p>
</div>
<div id="exercise-1" class="section level2">
<h2>Exercise (1)</h2>
<p>The exercise for step one is simple. Simply run the function with an example peptide: <font color="blue">DIAK</font>. <img src="DIAK.png" style="width:40.0%" alt="DIAK Structure" /></p>
<p>This peptide has 4 ionizable groups: Aspartic acid, Lysine, the N-terminus, and the C-terminus. We will evaluate the charge of this peptide at 2 different pH values: 7.0 and 3.0.</p>
<p>After ensuring that you have loaded the <code>pep_charge()</code> function, try it out in the console. We will set <code>peptide = "DIAK"</code> and <code>pH = 7.0</code> first. Type or copy and paste the code below into your console and press enter.</p>
<pre class="r"><code>pep_charge(peptide = &quot;DIAK&quot;, pH = 7.0)</code></pre>
<pre><code>##   ion_group ion_type  pKa count single_charge net_charge
## 1    N_term    basic  8.6     1  0.9754966324  0.9754966
## 2         H    basic  6.5     0  0.2402530734  0.0000000
## 3         K    basic 10.8     1  0.9998415358  0.9998415
## 4         R    basic 12.5     0  0.9999968377  0.0000000
## 5         C   acidic  8.5     0 -0.0306534300  0.0000000
## 6         D   acidic  3.9     1 -0.9992063022 -0.9992063
## 7         E   acidic  4.1     0 -0.9987426575  0.0000000
## 8         Y   acidic 10.1     0 -0.0007936978  0.0000000
## 9    C_term   acidic  3.6     1 -0.9996020513 -0.9996021</code></pre>
<pre><code>## [1] -0.02347019</code></pre>
<p>The first printout is the dataframe that we used to create each charge. Can you tell what each column is for? Read through the <code>pep_charge()</code> code above, and compare it to this dataframe to determine how each value is calculated.</p>
<p>The second printout is the net charge that we calculated. It is negative, but very close to 0, indicating that this peptide is close to neutral at pH 7.0 even though there are 4 charged groups. This is because the positive charges of the N-terminus and the Lysine cancel out the negative charges of the Aspartate and the C-terminus. Lets try the same thing at pH 3.0.</p>
<p>Notice that there are a lot of extra significant figures in these printouts. There are ways to deal with this if you want to (look up the <code>round()</code> function), but for the purpose of this project we aren’t going to worry about that. It’s never a bad idea to carry extra sig figs through your calculations, and its ultimately up to the researcher to decide how many figures to report in the final result.</p>
<pre class="r"><code>pep_charge(peptide = &quot;DIAK&quot;, pH = 3.0)</code></pre>
<pre><code>##   ion_group ion_type  pKa count single_charge net_charge
## 1    N_term    basic  8.6     1  9.999975e-01  0.9999975
## 2         H    basic  6.5     0  9.996839e-01  0.0000000
## 3         K    basic 10.8     1  1.000000e+00  1.0000000
## 4         R    basic 12.5     0  1.000000e+00  0.0000000
## 5         C   acidic  8.5     0 -3.162268e-06  0.0000000
## 6         D   acidic  3.9     1 -1.118158e-01 -0.1118158
## 7         E   acidic  4.1     0 -7.358756e-02  0.0000000
## 8         Y   acidic 10.1     0 -7.943282e-08  0.0000000
## 9    C_term   acidic  3.6     1 -2.007600e-01 -0.2007600</code></pre>
<pre><code>## [1] 1.687422</code></pre>
<p>At this lower pH, the charge of the peptide is more than 1.5 and less than 2. Why is this? Both of the basic residues are essentially fully charged at this pH (see the <code>net_charge</code> column), but only about 10% and 20% of the Asp and C-term are negatively charged. When these charges are added up, we get a value of +1.7 for the net charge of the peptide.</p>
<p><font color="purple">Take screenshots of your console showing the dataframe and net charge for DIAK at pH 7 and pH 3, and paste this into your assignment. Predict the charge of “DIAK” at pH 12, and feel free to run <code>pep_charge()</code> at that pH to check your answer.</font></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
