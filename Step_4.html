<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Step 4</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 45px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h2 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h3 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h4 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h5 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h6 {
  padding-top: 50px;
  margin-top: -50px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">HOME</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Resources.html">Resources</a>
</li>
<li>
  <a href="Background.html">Background</a>
</li>
<li>
  <a href="Step_1.html">Step 1</a>
</li>
<li>
  <a href="Step_2.html">Step 2</a>
</li>
<li>
  <a href="Step_3.html">Step 3</a>
</li>
<li>
  <a href="Step_4.html">Step 4</a>
</li>
<li>
  <a href="Assignment.html">Assignment</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Step 4</h1>

</div>


<div id="further-applications---peptide-summary-function-ph-vs-charge-plot-isoelectric-point-calculator" class="section level2">
<h2>Further applications - Peptide summary function, pH vs charge plot, Isoelectric point calculator</h2>
<p>For steps 1-3, hopefully most students were able to follow along and complete the objectives. The point of this project is to show that even without an extensive knowledge of coding, it is possible to take published scripts and functions and use them for your own data, even making simple modifications. Step 4 involves writing your own code from scratch, which I acknowledge takes more experience and more extensive background knowledge with a programming language. However, there are many excellent free resources online for diving into this sort of challenge. The best way to start out coding from scratch is to identify a question and work at it until a solution presents itself. In this section I will present several ‘questions’ that relate to the problems discussed in steps 1-3. There are many ways to successfully complete these challenges, but I will post possible solutions for each one <a href="https://github.com/weaversd/R_with_peptides_Project/tree/gh-pages/R_scripts">here</a> on git-hub. They are roughly in order of difficulty from easiest to hardest.</p>
<p>There are some general tips at the bottom of this page if you are stuck but don’t want to look at the answers! In addition, going back to <a href="https://www.tutorialspoint.com/r/index.htm">Tutorialspoint.com</a> after you have done some exercises can be a great way to reinforce what you’ve learned and pick up on new stuff. Finally, <a href="https://swcarpentry.github.io/r-novice-inflammation/02-func-R/">here is another good tutorial on writing your own functions from Software Carptentry</a>. They have many other good tutorials as well.</p>
<p>Make a good faith effort at trying these out from scratch. However, don’t be afraid to use the example solutions from the link above for hints if you are really stuck. Remember, being able to take code from other places and use it for your own data is a useful skill!</p>
</div>
<div id="exercise-4a" class="section level2">
<h2>Exercise (4a)</h2>
<p>We now have functions that calculate the charge of a peptide, the mass of a peptide, the m/z at a given pH of a peptide, and the expected m/z of a peptide in a MALDI spectrum. It would be helpful if we had a function that could summarize all of them. The goal for this function is to take a peptide and a pH, and print out all of the attributes we can calculate. Here is a framework with which to write your function.</p>
<pre class="r"><code>peptide_summary &lt;- function(peptide, pH){
  
  #Your code goes here
  
}</code></pre>
<p><font color="purple">Take a screenshot of your code and paste it into the assignment. Use your <code>peptide_summary()</code> function to calculate all the attributes for your favorite peptide (You can make one up!)</font></p>
</div>
<div id="exercise-4b" class="section level2">
<h2>Exercise (4b)</h2>
<p>We have a function that can calculate the charge of a peptide at any given pH. Can we use this to create a plot of the charge of a peptide over a large range of pH? This is useful for quickly estimating the isoelectric point of a peptide, or predicting its behavior in different buffers or separation methods. The goal of this exercise is to create a plot like this, which is for the peptide DIAK: <img src="DIAK%20ph%20charge%20plot.png" alt="DIAK charge vs pH plot" /> This takes some knowledge of how to create plots in R. The easiest way is to simply call two vectors or lists which are x and y coordinates to the function <code>plot()</code> like this <code>plot(pH_list, charge_list)</code>. If you are interested in data visualization, there is a very powerful package called <a href="https://ggplot2.tidyverse.org/">ggplot2</a> that is relatively easy to understand and can create beautiful graphs and charts.</p>
<p>Try doing this from scratch. Some pseudocode is below to help you get started if you are stuck.</p>
<pre><code>Pseudo code:

pH is a list of 1000 pH values from 0 to 14
charge is a list of 1000 values

for each value in list pH,
  calculate the charge for peptide &quot;DIAK&quot; and store it in the list charge
  
plot pH and charge</code></pre>
<pre><code>Helpful functions:
seq(x, y, z) creates a vector of numbers that goes from x to y, incrementing by z
rep(x, y) creates a vector of length y, and each value is x
length(x) returns the length of a vector or list x</code></pre>
<p><font color="purple">Take a screenshot of your code and paste it into the assignment. Also take a screenshot of the plot for your favorite peptide (you can make one up!) and paste it into the assignment.</font></p>
</div>
<div id="exercise-4c" class="section level2">
<h2>Exercise (4c)</h2>
<p>Isoelectric point is the point that a protein or peptide has a net charge of 0. We can estimate this based on the graph we created in Exercise 4b (for DIAK it is approximately 6.3) but it would be helpful if we were able to create a function that calculated this for us. Here is a framework for the function:</p>
<pre class="r"><code>pep_pI &lt;- function(peptide){
  
  #your code goes here
  
}</code></pre>
<p><a href="https://biologydirect.biomedcentral.com/articles/10.1186/s13062-016-0159-9">A paper from Dr. Kozlowski</a> nicely presents a methodology to do this. The general idea is to start at an ‘average’ pH (let’s use 7) and see what the charge is. Depending on whether it is positive or negative, try a new pH that is lower or higher, and repeat this process until you reach zero charge. There are several things to consider.:</p>
<ul>
<li>How far do we move from the previous pH value to the new one?</li>
<li>Do we do this an arbitrary number of times? OR</li>
<li>Do we do this until the charge is <em>close</em> enough to zero?</li>
</ul>
<p>An easy answer to the first question is to simply divide the search area in half each time. For example, suppose we try pH 7 and get a negative charge value. We know the pI will be lower than pH 7, so we divide the pH range 0-7 in half and try again at 3.5. This time, the charge is positive, so we know that the pI is higher than 3.5, but lower than 7. Now we divide this range in half and try again at 5.25. We continue this process either for a certain number of iterations, or until the charge is close enough to zero.</p>
<p><font color="purple">Take a screenshot of your code and paste it into the assignment. Calculate the pI of one of the peptides from exercise 2 or 3, and report that value in the assignment.</font></p>
</div>
<div id="additional-exercises" class="section level2">
<h2>Additional Exercises</h2>
<p>Some additional questions and exercises are listed below. Feel free to get creative and answer your own questions!</p>
<ul>
<li>How would we deal with peptides that are modified? For example: <font color="blue">DALC:mK</font>, where the C:m is a modified cysteine residue.</li>
<li>Run a comparison study between three different sets of pKa values on a standard set of peptides.</li>
<li>create a peptide mass function that uses average mass instead of mono-isotopic mass.</li>
</ul>
</div>
<div id="helpful-tips" class="section level2">
<h2>Helpful tips</h2>
<div id="anatomy-of-a-function" class="section level3">
<h3>Anatomy of a function</h3>
<div class="figure">
<img src="Anatomy%20of%20a%20function.png" style="width:75.0%" alt="" />
<p class="caption"><em>From tutorialspoint.com/r</em></p>
</div>
<p><a href="https://swcarpentry.github.io/r-novice-inflammation/02-func-R/">Here is a great tutorial on how to write functions in R</a></p>
</div>
<div id="how-to-call-a-function-within-a-function" class="section level3">
<h3>How to call a function within a function</h3>
<p>This is an incredibly important aspect of writing functions. You often want to create a function that makes use of another function that you’ve already written. For an example of this, go back to <em>Step 1</em> and look at the <code>pep_charge()</code> function. This is a function that is written from scratch, but it uses several other functions within it. The first thing it does, is to call the function <code>toupper()</code> on <code>peptide</code>. It then assigns the result of this computation to the variable <code>peptide</code>, essentially overriding it. <code>toupper()</code> is a function, and you can use it (or any other function) within another function the same way you would in the terminal: typing it and supplying arguments. However, within a function, you often want to assign the output of the function to a variable with the <code>&lt;-</code> symbol. See if you can find other examples of this throughout the exercise, like in the <code>pep_mass()</code> function.</p>
</div>
<div id="the-difference-between-print-and-return" class="section level3">
<h3>The difference between <code>print()</code> and <code>return()</code></h3>
<p><code>print()</code> is simply a function to show the user the result of some calculation, by ‘printing’ it in the terminal. The computer can’t use this value. <code>return()</code> is often used within a function, and it stores or ‘returns’ the result of a calculation so that the computer is able to use it. This value is what is saved when the output of a function is stored in a variable. Using <code>print()</code> won’t disrupt a function (it is only there for the user’s benefit), but using <code>return()</code> will end a function.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
